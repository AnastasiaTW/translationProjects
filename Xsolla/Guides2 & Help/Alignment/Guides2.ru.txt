<div class="content">

<div class="section-content">

<div class="section-description">

# [Xsolla Login](#xsolla_login)

Xsolla Login — система, предназначенная для разработчиков игр и приложений. В рамках подключения к Xsolla Login создается специальное приложение, позволяющее упростить процесс регистрации новых пользователей в игре, если они уже имеют учетную запись в социальных сетях. Кроме этого, с согласия пользователей, возможно получить доступ к информации из профиля в социальной сети для более глубокой интеграции с проектом.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Руководство по интеграции](#integration_guide)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Подготовка к работе](#getting_started)

Для начала работы необходимо зарегистрировать приложение, написав письмо на [bizdev@xsolla.com](mailto:bizdev@xsolla.com).

В письме необходимо указать:

*   **Сайт** — адрес сайта игры, к которому планируется подключить Xsolla Login, например ht<span>tp://mysite.com</span>.
*   **Базовый домен** — базовый домен сайта, например, mysite.com. Можно указать несколько доменных имен, и, если есть необходимость, использовать один _projectId_ на разных доменах.
*   **Список способов аутентификации** — список возможных способов аутентификации. Доступные варианты:
    *   аутентификация через логин/пароль,
    *   через SMS,
    *   социальные сети ((Facebook, Twitter, Steam, Twitch, VK, Naver, и т.д.),
    *   i-pin (BETA),
    *   многофакторная аутентификация (BETA),
    *   сертификат (BETA)
    *   локальные социальные сети (BETA).

Также необходимо указать список социальных сетей, через которые должна быть доступна аутентификация.

В ответном письме мы пришлем вам _projectId_ и _secretKey_.

<aside class="warning">Обратите внимание, вызовы методов Xsolla Login можно осуществлять только на страницах с URL, принадлежащим базовому домену.</aside>

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Виджет аутентификации](#xlwidget)

Рассмотренный ниже пример добавляет виджет аутентификации стандартного вида. Вы можете настроить внешний вид блоков при помощи css. Шаблон SCSS доступен для скачивания по [ссылке](../files/xl-scss.zip).

По умолчанию ширина блока 400px, высота зависит от аутентификационных опций.

[![Example of a default design](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/developers_login_01.c7be3b3cc6.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/developers_login_01.c7be3b3cc6.png "Example of a default design") [ ![Example of a custom design](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/lif-login.af452a849d@1x.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/lif-login.af452a849d@1x.png "Example of a custom design") [ ![Example of a custom design](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/capital-login.035af309f8@1x.png)](https://cdn.xsolla.net/developers.xsolla.com/images/gallery/capital-login.035af309f8@1x.png "Example of a custom design")

### [Подключение виджета](#xlwidget_подключение-виджета)

Для добавления виджета аутентификации Xsolla Login в игру, выполните следующие шаги:

1.  В тег <head> добавьте подключение js-sdk.js:

    <script src="https://static.xsolla.com/xsolla-login/1.1.1/xl.min.js"></script>

1.  В тег <body> добавьте код для инициализации:

    <script type="text/javascript">
    XL.init({
             projectId: '40db2ea4-5p47-11e6-a3ff-005056a0e04a',
             locale: 'en_US',
             onlyWidgets: true,
             redirectUrl: '<your redirect url>',
             fields: 'email'
         });
    </script>

<table>

<thead>

<tr>

<th style="text-align:left">**Название**</th>

<th style="text-align:left">**Тип**</th>

<th style="text-align:left">**Описание**</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left">projectId</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Идентификатор приложения. **Обязательный**.</td>

</tr>

<tr>

<td style="text-align:left">locale</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Локаль пользователя в формате <language code>_<country code>, где:

*   _language code:_ код языка в формате [ISO 639 alpha-2](https://en.wikipedia.org/wiki/List_of_ISO_639-2_codes);
*   _country code:_ код страны (региона) в формате [ISO 3166-1 alpha-2](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2).

</td>

</tr>

<tr>

<td style="text-align:left">redirectUrl</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Адрес, на который следует перенаправить пользователя после аутентификации. [Передается в jwt-токене.](#server_side)</td>

</tr>

<tr>

<td style="text-align:left">onlyWidgets</td>

<td style="text-align:left">boolean</td>

<td style="text-align:left">Инициализировать ли Xsolla Login только для подключения виджетов. 'true' по умолчанию.</td>

</tr>

<tr>

<td style="text-align:left">preloader</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Прелоадер, который будет показан до загрузки виджета. Необходимо указать html-код элемента.</td>

</tr>

<tr>

<td style="text-align:left">fields</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Данные, которые необходимо получить от пользователя. Допустимое значение: email. **Обязательный**</td>

</tr>

</tbody>

</table>

1.  Добавьте элемент DIV, в котором будет отображаться виджет, задайте ему уникальный id, и добавьте после него код инициализации виджета.

    <div id="xl_auth"></div>
    <script type="text/javascript">
    var element_id = 'xl_auth';
    var options = {
        width: '200px',
        height: '200px'
    };
    XL.AuthWidget(element_id, options);
    </script>

<table>

<thead>

<tr>

<th style="text-align:left">**Название**</th>

<th style="text-align:left">**Тип**</th>

<th style="text-align:left">**Описание**</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left">element_id</td>

<td style="text-align:left">string</td>

<td style="text-align:left">id элемента-контейнера для блока аутентификации. **Обязательный**</td>

</tr>

<tr>

<td style="text-align:left">options</td>

<td style="text-align:left">object</td>

<td style="text-align:left">Настройки блока с виджетом.</td>

</tr>

<tr>

<td style="text-align:left">options.width</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Ширина блока.</td>

</tr>

<tr>

<td style="text-align:left">options.height</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Высота блока.</td>

</tr>

</tbody>

</table>

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Xsolla Login Server Side](#server_side)

### [Схема взаимодействия](#server_side_схема-взаимодействия)

<div class="scheme login">

<div class="left-side">

<div class="block_1 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-start.3bce9008a7.png) <span class="xsolla-login-title">user redirected to redirecUrl</span></div>

<button class="scheme-toggler" id="scheme_toggler">Показать всю схему</button>

<div class="scheme-wrapper">

<div class="block_2 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-data.f3e1760e13.png) <span class="xsolla-login-title">redirectUrl?token=<token></span></div>

<div class="block_3 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-if.9f7e4cf29d.png) <span class="xsolla-login-title">token exist?</span><span class="true-text">true</span><span class="false-text">false</span></div>

<div class="block_4 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-if.9f7e4cf29d.png) <span class="xsolla-login-title">token valid?</span><span class="true-text">true</span> <span class="false-text">false</span></div>

<div class="block_5 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-if.9f7e4cf29d.png) <span class="xsolla-login-title">user exist?</span><span class="true-text">true</span> <span class="false-text">false</span>

<div class="create-user">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-fun.4710b04b36.png) <span class="xsolla-login-title">create user</span></div>

<div class="form-error">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-fun.4710b04b36.png) <span class="xsolla-login-title">form errorUrl</span></div>

</div>

<div class="block_6 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-fun.4710b04b36.png) <span class="xsolla-login-title">create successUrl</span></div>

<div class="block_7 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-fun.4710b04b36.png) <span class="xsolla-login-title">create domain specific user session</span></div>

<div class="block_8 blocks">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-yes.238586eb98.png) <span class="xsolla-login-title">redirect user to successUrl</span>

<div class="redirect-error">![](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/xsolla_login/xsolla-login-no.c98e3ebd52.png) <span class="xsolla-login-title">redirect user to errorUrl</span></div>

</div>

</div>

</div>

</div>

### [Callback URL](#server_side_callback-url)

URL, на который происходит перенаправление пользователя в браузере в конце процесса аутенификации.

### [Прохождение аутентификации. Успех](#server_side_прохождение-аутентификации.-успех)

В случае успеха пользователь будет переадресован на Ваш callback URL со следующим параметром:

**HTTP запрос**

`GET https://callBackUrl.php?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ`

<table>

<thead>

<tr>

<th style="text-align:left">Параметр</th>

<th style="text-align:left">Тип</th>

<th style="text-align:left">Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left">token</td>

<td style="text-align:left">string</td>

<td style="text-align:left">[JWT-token](https://en.wikipedia.org/wiki/JSON_Web_Token). Вы можете [дешифровать его](https://jwt.io), используя секретный ключ.</td>

</tr>

<tr>

<td style="text-align:left">is_linking</td>

<td style="text-align:left">boolean</td>

<td style="text-align:left">Пользователь прилинковал аккаунт.</td>

</tr>

</tbody>

</table>

#### [Пример дешифрованного токена](#server_side_пример-дешифрованного-токена)

    {
      "exp": 1471071785,
      "iss": "https://login.xsolla.com",
      "iat": 1470985385,
      "id": "11111111",
      "name": "John Carter",
      "email": "john@example.com",
      "type": "social",
      "provider": "social_network",
      "xsolla_login_access_key": "s4dGNSPKinUxkSRI8rhPhZRElHj2yusqEeqgLIgn"
    }

<table>

<thead>

<tr>

<th style="text-align:left">Параметр</th>

<th style="text-align:left">Тип</th>

<th style="text-align:left">Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left">exp</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Дата окончания действия токена. (Unix time)</td>

</tr>

<tr>

<td style="text-align:left">iss</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Указание, кто выдал JWT-token.</td>

</tr>

<tr>

<td style="text-align:left">iat</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Дата создания. (Unix time)</td>

</tr>

<tr>

<td style="text-align:left">id</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Идентификатор пользователя.</td>

</tr>

<tr>

<td style="text-align:left">name</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Полное имя пользователя.</td>

</tr>

<tr>

<td style="text-align:left">email</td>

<td style="text-align:left">string</td>

<td style="text-align:left">email пользователя.</td>

</tr>

<tr>

<td style="text-align:left">type</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Тип аутентификации. Допустимые значения: "proxy" — проксированная аутентификация; "social" — вход через социальную сеть.</td>

</tr>

<tr>

<td style="text-align:left">provider</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Название социальной сети. Список допустимых значений: "vk", "facebook", "twitter", "steam", "baidu", "naver", "qq", "github", "microsoft", "linkedin", "google".</td>

</tr>

<tr>

<td style="text-align:left">xsolla_login_access_key</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Ключ доступа для вызова методов от имени пользователя.</td>

</tr>

</tbody>

</table>

### [Прохождение аутентификации. Ошибка](#server_side_прохождение-аутентификации.-ошибка)

В случае ошибки, пользователь будет перенаправлен на Ваш callback URL со следующими [параметрами:](../api_v2.html#login_error)

**HTTP запрос**

`GET https://callBackUrl.php?error=003-002&error_description=User+not+found&redirect_url=https://site.com/fail_url`

<table>

<thead>

<tr>

<th style="text-align:left">Параметр</th>

<th style="text-align:left">Тип</th>

<th style="text-align:left">Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left">error</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Группа кодов ошибок.</td>

</tr>

<tr>

<td style="text-align:left">error_description</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Описание ошибки.</td>

</tr>

<tr>

<td style="text-align:left">redirect_url</td>

<td style="text-align:left">string</td>

<td style="text-align:left">Callback URL проекта.</td>

</tr>

</tbody>

</table>

### [Дополнительные методы API](#server_side_дополнительные-методы-api)

Проксированная аутентификация может быть использована в том случае, если у Вас уже есть база пользователей. В этом случае необходимо реализовать следующие методы:

Xsolla Login будет вызывать методы с адресов [https://login.xsolla.com/](https://login.xsolla.com/) и [https://test-login.xsolla.com/](https://test-login.xsolla.com/)

#### [Проверка логина/пароля](#server_side_проверка-логина-пароля)

*   Тип: POST
*   Content-type: application/json
*   Тело запроса: _{"username":"ХХХХ", "password":"ХХХХ"}_
*   Успех: _{Ok 200}_
*   Неудачный запрос: _{"error": {"code": “003-001”, "description": "" }}_

#### [Регистрация](#server_side_регистрация)

*   Тип: POST
*   Content-type: application/json
*   Тело запроса: _{"username":"ХХХХ", "password":"ХХХХ", "email":"ХХХХ"}_
*   Успех: _{Ok 200}_
*   Неудачный запрос: _{error: {code: “003-003|004”, description: “” }}_

#### [Сброс пароля](#server_side_сброс-пароля)

*   Тип: POST
*   Content-type: application/json
*   Тело запроса: _{"email":"ХХХХ"}_
*   Успех: _{Ok 200}_
*   Неудачный запрос: _{"error": {"code": “003-002”, "description": ""}}_

</div>

</div>

</div>

<div class="content">

<div class="section-content">

<div class="section-description">

# [Xsolla Data Portal на базе Slemma](#data-portal-intro)

Этот гайд поможет вам ориентироваться в нашем [демо-примере](https://slemma.com/demo/xsolla-payments), и лучше понимать, как вы можете использовать данные отчеты при работе с вашей платежной аналитикой в [Личном Кабинете](https://publisher.xsolla.com). Ниже представлена информация о том как анализировать [дашборды](#dashboards), описания ко всем разделам, определения для различных [метрик](#dataset-measures) и [измерений](#dataset_dimensions), а также список [Вопросов](#faq_data_portal). Если у вас возникнут вопросы, напишите нам на [dataportal@xsolla.com](mailto:dataportal@xsolla.com)!

<div class="video-container"><iframe src="https://www.youtube.com/embed/JSoLff-hv4A" frameborder="0" allowfullscreen="" class="video"></iframe></div>

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Дашборды](#dashboards)

Дашборд — это набор графиков и диаграмм, дающих вам возможность глубже анализировать конкретную проблему. Каждый из дашбордов позволит вам увеличить значения о какой-либо области деятельности вашей компании и принимать решения на основе анализируемых данных.

[![Общая информаци](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_overview.6fffd7990b.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_overview_real.7a176f7234.png "Общая информаци") [ ![Банки-эмитенты](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_banks.2b9cf765ca.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_banks_real.e406e8c539.png "Банки-эмитенты") [ ![Информация о доходе и трендах](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_revenue_trends.56c78e2f03.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_revenue_trends_real.6520500024.png "Информация о доходе и трендах") [ ![Данные о способах оплаты](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_payment_systems_revenue.63fb89cbeb.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_payment_systems_revenue_real.100e11768d.png "Данные о способах оплаты") [ ![Диаграмма платящих пользователей](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_paying_users.46cd6a1f7c.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_paying_users_real.fbfabd4e46.png "Диаграмма платящих пользователей") [ ![Доход в разрезе валют](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_revenue_currencies.e3b123289f.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_revenue_currencies_real.95a276f72c.png "Доход в разрезе валют") [ ![Конверсия кредитных карт](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_conversion.7f5cce99c0.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_conversion_real.92d5b03bc3.png "Конверсия кредитных карт") [ ![Причины отмен платежей](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_cancellations_reasons.5d5b82ea61.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_cancellations_reasons_real.e0fad6e649.png "Причины отмен платежей") [ ![Платящие пользователи в разрезе операционных систем](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_devices_operating_systems_paying_users.3b99bfe06e.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_devices_operating_systems_paying_users_real.c3ab2080a4.png "Платящие пользователи в разрезе операционных систем") [ ![Пузырьковая диаграмма по странам](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_geography_countries_bubbles.cbf6168677.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_geography_countries_bubbles_real.f234bfaf21.png "Пузырьковая диаграмма по странам") [ ![Данные о кредитных картах](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_insights.83a176fbe8.png) ](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_credit_cards_insights_real.0ef2022684.png "Данные о кредитных картах") [ ![Конверсия способов оплаты](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_payment_systems_conversion.8f9d26abe3.png)](https://cdn.xsolla.net/developers.xsolla.com/images/data-portal/data-portal_payment_systems_conversion_real.2443c0ce2c.png "Конверсия способов оплаты")

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Основные понятия](#dashboards-concepts)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Фильтры](#-)

Для каждого дашборда есть несколько фильтров, расположенных в верхней части страницы, которые позволяют вам фильтровать данные по разным [измерениям](#dataset_dimensions). Чтобы использовать эти фильтры, выберите один и установите флажки измерений, по которым вы бы хотели ограничить выборку. Например, если в фильтре **User Country** выбрать _United States_, то на дашборде будут показаны данные о платежах только из _United States_. Чтобы исключить данные из выборки, используйте режим 'Exclude' в меню фильтра (меню появляется при нажатии на три точки справа от названия фильтра). Используйте фильтры, чтобы "углубиться" в данные об игре.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Значения показателей роста](#-)

Показатели роста сравнивают текущее состояние выбранных [метрик](#dataset_measures) с метриками за предыдущий период такой же длины. Зеленые, направленные вверх стрелки указывают на рост по сравнению с предыдущим периодом, а красные, направленные вниз стрелки означают падение.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Значения по выбранному периоду](#-)

В отличие от значений, которые показывают лишь агрегированные данные за выбранный период, эти значения корректируются на основе периода времени, установленного в фильтре **Date**. Используйте этот фильтр для изменения агрегированного периода времени на дашборде, и эти значения также изменятся.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Среднесуточные значения](#-)

В отличие от обычных значений, среднесуточные значения не будут увеличиваться при увеличении периода. Например, **ARPPU** будет расти при увеличении периода, потому что те же пользователи будут продолжать платить. Усредненный доход на платящего ежедневно активного пользователя (ARPPDAU) не будет расти, так как это среднее значение от всех средних значений за период, а не от общего количества платежей и среднего количества платящих пользователей.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Агрегация по неделям и месяцам](#-)

Если вы выберите определенный период в фильтре **Date**, например 4 недели, то данные будут показаны, разделенные по неделям и показывать 4 недели. Агрегация данных за эти недели будет на основе всей активности за эти недели, а не средней от средних данных за день, которая будет показана, когда выбран фильтр по дням.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Параллельный период](#-)

Графики параллельного периода позволят вам сделать анализ тренда.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Скользящая средняя](#-)

Скользящая средняя является еще одним способом анализа тенденций. Временные рамки, используемые в расчетах, отображаются в названии метрик. Естественно, длительные временные отрезки дадут меньшую волатильность и покажут общую тенденцию рассматриваемого периода. Мы используем простую скользящую среднюю.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Скачать любой график в excel](#-excel)

При необходимости вы можете загрузить данные непосредственно из диаграммы. Щелкните правой кнопкой мыши по графику и загрузите данные в формате CSV, XLS, а также в PNG для использования в презентациях.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Справочник дашбордов](#dashboards-reference)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Обзорный](#-a-href-https-slemma-com-share-3c42a1225b24aed8882b23874b8b827c4e8811b6-target-_blank-demo-a-) [(demo)](https://slemma.com/share/3c42a1225b24aed8882b23874b8b827c4e8811b6)

Обзорный дашборд содержит KPI вашей игры, идеален для ежедневного анализа, а также для показа на вашем офисном TV. Включает **Gross Revenue**, **Payments**, **Paying Users**, **ARPPU**, **Paid Invoices** и **Average Payment Amount**.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Игры](#-a-href-https-slemma-com-share-57107d069f10200b7cc0fae2a514052350b9dbec-target-_blank-demo-a-) [(demo)](https://slemma.com/share/57107d069f10200b7cc0fae2a514052350b9dbec)

Игровой дашборд создан для анализа различных платежных ситуаций в ваших играх. Метрики заложены вместе с регулярными фильтрами, так что вы можете определить приоритеты и оценить разницу между вашими проектами.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Платежные системы](#-a-href-https-slemma-com-share-d761565a4d0a355ac3be414e5c3330f8f98f792f-target-_blank-demo-a-) [(demo)](https://slemma.com/share/d761565a4d0a355ac3be414e5c3330f8f98f792f)

Понимание того, как платят ваши пользователи может быть столь же важным, как и ответ на вопрос: "почему?". Данный дашборд должен помочь вам понять как различные подгруппы ваших пользователей совершают платежи и как вы можете оптимизировать свой сайт, показывая наиболее подходящие и наиболее популярные платежные системы.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Кредитные карты](#-a-href-https-slemma-com-share-b7cdfeab7e5d08c88b51b2c1d10b8c6c584f18cc-target-_blank-demo-a-) [(demo)](https://slemma.com/share/b7cdfeab7e5d08c88b51b2c1d10b8c6c584f18cc)

Дашборд кредитных карт полностью посвящен данным о кредитных картах. Анализ конверсии, причины отказа, а также информация о том как много пользователей разрешили Xsolla сохранить их платежные данные для будущих покупок (надежный индикатор их намерения еще вернуться в игру)!

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Revenue](#revenue-a-href-https-slemma-com-share-279ee8a542f1f79b6d637d28ebcd0228bacc2869-target-_blank-demo-a-) [(demo)](https://slemma.com/share/279ee8a542f1f79b6d637d28ebcd0228bacc2869)

Revenue-дашборд предлагает несколько различных способов анализа тенденций. В данный дашборд включены параллельные периоды, средняя скользящая и диаграммы роста, все они могут помочь вам строить прогнозы. Также дашборд содержит лист валют; вы можете убедиться, что предлагаете все валюты, соответствующие областям присутствия ваших проектов.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Платящие пользователи](#-a-href-https-slemma-com-share-63c1084fc0efc9dd57e95bd7ce1050015e93fe4d-target-_blank-demo-a-) [(demo)](https://slemma.com/share/63c1084fc0efc9dd57e95bd7ce1050015e93fe4d)

Paying Users дашборд — это способ понять характеристики вашего **Revenue**. Если **Revenue** увеличивается вы можете задать вопрос: новые пользователи становятся **Paying Users** или **Existing Paying Users** платят больше?

</div>

</div>

<div class="section-content">

<div class="section-description">

## [ARPPU](#arppu-a-href-https-slemma-com-share-504433146eb4d07cbcb67ad2f0467f29aed6f17e-target-_blank-demo-a-) [(demo)](https://slemma.com/share/504433146eb4d07cbcb67ad2f0467f29aed6f17e)

Average Revenue Per Paying User (ARPPU) это еще один способ увидеть характерное платежное поведение ваших пользователей. Данный дашборд также включает единичные значения Average Revenue Per Paying Daily Active User, который не увеличивается с течением времени от пользователей, совершивших единичный платеж.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Виртуальная валюта](#-a-href-https-slemma-com-share-d185809a81a17fa74c872926a2cb66367ecd636c-target-_blank-demo-a-) [(demo)](https://slemma.com/share/d185809a81a17fa74c872926a2cb66367ecd636c)

Дашборд виртуальной валюты будет информировать вас о том как много пользователей совершили покупки, расплатившись внутриигровой валютой. Также вы можете загрузить ваши внутриигровые данные о потраченной игровой валюте, создать сравнительный дашборд и проверить здоровье вашей внутриигровой экономики.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [География](#-a-href-https-slemma-com-share-1e3730294de65cf1904c2985dd815f836a6d2a77-target-_blank-demo-a-) [(demo)](https://slemma.com/share/1e3730294de65cf1904c2985dd815f836a6d2a77)

Дашборд поможет понять разницу между платежными привычками пользователей в зависимости от их местоположения. Каждый лист сгруппирован по различным признакам, включая такие как: **Countries**, **Regions**, **Languages**, **Business Regions** и **Timezones**.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Девайсы](#-a-href-https-slemma-com-share-e3e689debbec5a0a0d5ec4efd74a92eee8ffa6d8-target-_blank-demo-a-) [(demo)](https://slemma.com/share/e3e689debbec5a0a0d5ec4efd74a92eee8ffa6d8)

Дашборд включает информацию об опыте пользователя в вашем интерфейсе. Вы можете использовать данную информацию для оптимизации вашего сайта для наиболее популярных девайсов и быть уверенным, что он работает в самых распространенных браузерах.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Отмены](#-a-href-https-slemma-com-share-4ba43a6b1671d29c9004991fe337ec62c82aaa0b-target-_blank-demo-a-) [(demo)](https://slemma.com/share/4ba43a6b1671d29c9004991fe337ec62c82aaa0b)

Дашборд позволит вам следить за фродом в вашей игре. Обзор листов будет показывать число отмен в **Cancellation Date**, **Payment Date**, как в процентах, так и географически. Список причин даст вам возможность увидеть распределение причин отмены для каждой отмены.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Xsolla Dataset](#xsolla-dataset)

Все эти предустановленные дашборды действительно хороши, но что если вы хотите создать свой собственный? Вы можете сделать это с помощью предоставленного Xsolla Dataset! Вы можете создать неограниченное количество дашбордов с вашим [Slemma](https://slemma.com)-аккаунтом и вашими данными; постройте любой график с любыми метриками или измерениями.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Измерения](#dataset_dimensions)

Измерения отличаются от данных. Это не сами значения, но определенные категории значений. Всякий раз, когда вы используете фильтр, вы фильтруете данные по измерению.

Примеры измерений: **Countr**y, **Credit Card Type**, **Date**, и.т.д.

<table>

<thead>

<tr>

<th>Группа</th>

<th>Название</th>

<th>Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td>DateTime</td>

<td><nobr>**Date**</nobr></td>

<td>Дата по умолчанию для всех графиков в часовом поясе формата UTC. Данная дата основывается на последнем обновлении платежного статуса (invoice, payment, cancellation). Пример: когда вы хотите добавить платежи или отмены на единую временную шкалу, платежи будут агрегироваться по дате платежа, отмены — по дате отмены.</td>

</tr>

<tr>

<td>DateTime</td>

<td><nobr>**Invoice Date**</nobr></td>

<td>Дата создания заявки в UTC .</td>

</tr>

<tr>

<td>DateTime</td>

<td><nobr>**Payment Date**</nobr></td>

<td>Дата подтверждения платежа в UTC. Данная дата доступна только для завершенных платежей и не доступна для неоплаченных заявок.</td>

</tr>

<tr>

<td>DateTime</td>

<td><nobr>**Cancellation Date**</nobr></td>

<td>Дата отмены платежа в UTC. Данные доступны для отмененных платежей.</td>

</tr>

<tr>

<td>Projects</td>

<td><nobr>**Project**</nobr></td>

<td>ID пректа и название проекта</td>

</tr>

<tr>

<td>Payment System</td>

<td><nobr>**Payment System Group**</nobr></td>

<td>Группа платежных систем, например: _Cash Payments_, _Bank Transfer_</td>

</tr>

<tr>

<td>Payment System</td>

<td><nobr>**Payment System**</nobr></td>

<td>ID платежной системы и название, например: _24\. Paypal_, _57\. PaySafeCard_</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**User Country**</nobr></td>

<td>Страна пользователя, определена системой Xsolla. Вычисленная страна является наиболее точной и подходящей. IP-адрес пользователя, страна мобильного оператора, страна банка, выпустившего кредитную карту и другие атрибуты используются для определения страны. Данная страна используется для внутренних вычислений VAT.</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**Language**</nobr></td>

<td>Язык. Используется 2-буквенный код, вида _EN_, _PT_, _RU_</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**IP Address Geography**</nobr></td>

<td>Местоположение пользователя, вычисляется на основании IP-адреса. Данная иерархия содержит точную географическую информацию о _Region_ и _Country_ с _Country Subdivision_ и _City_.</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**Timezone**</nobr></td>

<td>Часовой пояс пользователя, определяется на основе IP-адреса пользователя, например: _Europe/Berlin_, _America/Chicago_</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**Business Region**</nobr></td>

<td>Бизнес-регион в **User Country**, например: _European Union_, _Latin America_</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**Payment System Country**</nobr></td>

<td>Страна происхождения платежной системы</td>

</tr>

<tr>

<td>Geography</td>

<td><nobr>**Issuing Bank Country**</nobr></td>

<td>Страна банка, выпустившего карту польззователя</td>

</tr>

<tr>

<td>Currencies</td>

<td><nobr>**Payment Currency**</nobr></td>

<td>Валюта платежа пользователя, 3-буквенное обозначение, вида: _USD_, _EUR_</td>

</tr>

<tr>

<td>Currencies</td>

<td><nobr>**Payout Currency**</nobr></td>

<td>Валюта выплаты банку-партнеру, 3-буквенное обозначение, вида: _USD_, _EUR_</td>

</tr>

<tr>

<td>Purchase</td>

<td><nobr>**Purchase Type**</nobr></td>

<td>Модуль Xsolla, использованный для совершения платежа: _Virtual Items_, _Virtual Currency_</td>

</tr>

<tr>

<td>Purchase</td>

<td><nobr>**Is First Payment**</nobr></td>

<td>_True_, если это первый платеж для данного юзера, _false_ в противном случае</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Is Credit Card**</nobr></td>

<td>_True_, если платеж совершен через кредитную карту, _false_ в противном случае</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Issuing Bank**</nobr></td>

<td>Банк, выпустивший кредитную карту</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Credit Card Brand**</nobr></td>

<td>e.g _VISA_, _MasterCard_</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Credit Card Type**</nobr></td>

<td>e.g. _CREDIT_, _DEBIT_</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Credit Card Category**</nobr></td>

<td>e.g. _CLASSIC_, _GOLD_, _PLATINUM_</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Is Payment Account Saved**</nobr></td>

<td>_True_ если пользователь позволил Xsolla сохранить его платежную информацию для будущих покупок, _false_ в противном случае</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Is Payment From Saved Account**</nobr></td>

<td>_True_, если платеж был совершен с использованием сохраненной ранее платежной информации пользователя, _false_ в противном случае</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Is Credit Card Rejected**</nobr></td>

<td>_True_, если кредитная карта была отклонена во время процесса оплаты, _false_ в противном случае. Причину отмены можно найти в измерении **Credit Card Reject Reason**</td>

</tr>

<tr>

<td>Credit Cards</td>

<td><nobr>**Credit Card Reject Reason**</nobr></td>

<td>e.g. _Insufficient Funds_, _Did not pass validation 3D-secure_</td>

</tr>

<tr>

<td>Recurring Payments</td>

<td><nobr>**Is Recurrent Plan Created**</nobr></td>

<td>_True_, если из платежа была создана рекуррентная подписка, _false_ в противном случае</td>

</tr>

<tr>

<td>Recurring Payments</td>

<td><nobr>**Is Recurrent Payment**</nobr></td>

<td>_True_, если списание с карты было совершено для оплаты рекуррентной подписки, _false_ в противном случае</td>

</tr>

<tr>

<td>User Agent</td>

<td><nobr>**OS**</nobr></td>

<td>Операционная система на девайсе пользователя, например: _Windows 8_, _MacOS_, _Android_</td>

</tr>

<tr>

<td>User Agent</td>

<td><nobr>**Browser**</nobr></td>

<td>Браузер пользователя, например: _Firefox_, _Chrome Mobile_</td>

</tr>

<tr>

<td>User Agent</td>

<td><nobr>**Device**</nobr></td>

<td>Модель мобильного устройства пользователя, например: _IPhone_, _Nokia Lumia_</td>

</tr>

<tr>

<td>User Agent</td>

<td><nobr>**Screen Size**</nobr></td>

<td>Разрешение экрана девайса пользователя</td>

</tr>

<tr>

<td>User Agent</td>

<td><nobr>**UI**</nobr></td>

<td>Интерфейс Xsolla, через который был совершен платеж, например: _PayStation_, _Smartphone Version_</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment Notification Delivery**</nobr></td>

<td>Продолжительность обработки платежа на стороне Xsolla, например: _1-3 seconds_, _1-10 minutes_</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment System Delay**</nobr></td>

<td>Продолжительность обработки платежа на стороне платежной системы, например: _1-3 seconds_, _1-10 minutes_</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment Flow**</nobr></td>

<td>Общая продолжительностьобработки платежа, например: _1-3 seconds_, _1-10 minutes_</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Is Cancelled**</nobr></td>

<td>_True_, если платеж отменен, _false_ в противном случае. Причины отмены можно найти в измерении **Cancellation Type**</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Cancellation Type**</nobr></td>

<td>Причины отмены транзакции, например: _Refund_, _Chargeback_</td>

</tr>

</tbody>

</table>

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Метрики](#dataset_measures)

Метрики, в отличие измерений, представляют собой значения, которые отображаются на графиках. Примеры метрик: **Revenue**, **Paying Users**, **Conversion**, **Average Payments Amount**.

<table>

<thead>

<tr>

<th>Группа</th>

<th>Название</th>

<th>Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td>Measures</td>

<td><nobr>**Revenue**</nobr></td>

<td>Сумма до вычета комиссий. Сумма конвертируется в валюту метрики по актуальному на дату уведомления проекта курсу .</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Average Payment Amount**</nobr></td>

<td>**Revenue**, деленное количество **Payments**</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Gross Revenue**</nobr></td>

<td>Сумма дохода **Revenue** без учета **Cancellations Revenue** за текущий период</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Payments**</nobr></td>

<td>Общая сумма завершенных платежей. Платежи могут быть отменены в будущих периодах.</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Virtual Currency Amount**</nobr></td>

<td>Количество приобретенной виртуальной валюты. Доступно в модуле _Virtual Currency_</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**ARPPU**</nobr></td>

<td>Average Revenue Per Paying User: **Revenue**, деленное на количество уникальных **Paying Users**. При использовании недельной или месячной агрегации **ARPPU** значительно возрастает, так как один пользователь может иметь несколько **Payments** за один период.</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Payments per Paying User**</nobr></td>

<td>Общее количество **Payments**, деленное на количество уникальных **Paying users**. Используется в еженедельных и ежемесячных агрегациях для аналитики частоты платежей.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Invoices**</nobr></td>

<td>Общее количество созданных заявок.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Users**</nobr></td>

<td>Общее количество пользователей, создавших **Invoice**. Пользователи, не завершившие платеж, также включены.</td>

</tr>

<tr>

<td>Measures</td>

<td><nobr>**Paying Users**</nobr></td>

<td>Количество уникальных пользователей, совершивших как минимум один **Payment**в рассматриваемый период</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Paying Users Percent**</nobr></td>

<td>Процент пользователей, завершивших платеж от общего числа пользователей, создавших заявку. **Paying Users Percent** более точное преобразование метрики (по сравнению с **Paid Invoices Percent**), так как пользователь может попробовать несколько способов оплаты, прежде чем завершит платеж.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Paid Invoices Percent**</nobr></td>

<td>Процент завершенных **Payments** по отношению к общему числу **Invoices**</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Churn Users**</nobr></td>

<td>Количество пользователей создавших, но не оплативших заявку.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Churn Users Percent**</nobr></td>

<td>Процент пользователей создавших, но не оплативших заявку.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Unpaid Invoices**</nobr></td>

<td>Количество заявок, которые не были завершены пользователем и не подтверждены платежной системой.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Unpaid Invoices Percent**</nobr></td>

<td>Процент **Unpaid Invoices** по отношению к общему количеству заявок</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**New Paying Users**</nobr></td>

<td>Количество уникальных **Paying users**, совершивших первый платеж в рассматриваемый период.</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**New Paying Users Percent**</nobr></td>

<td>Процент **New Paying Users** по отношению к общему числу **Paying Users**</td>

</tr>

<tr>

<td>Conversion</td>

<td><nobr>**Existing Paying Users**</nobr></td>

<td>Количество уникальных **Paying Users**, совершивших не первый платеж</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Cancellations**</nobr></td>

<td>Количество **Payments** которые были возвращены или отменены</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Cancellations Percent**</nobr></td>

<td>Процент **Cancellations** по отношению к общему числу **Payments**.</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Cancellations Revenue**</nobr></td>

<td>Количество отмененных **Payments**.</td>

</tr>

<tr>

<td>Cancellations</td>

<td><nobr>**Cancellations Revenue Percent**</nobr></td>

<td>Процент **Cancellations Revenue** по отношению к общему **Revenue**.</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment Notification Delivery, Seconds**</nobr></td>

<td>Продолжительность обработки платежа на стороне Xsolla</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment System Delay, Seconds**</nobr></td>

<td>Продолжительность обработки платежа на стороне платежной системы</td>

</tr>

<tr>

<td>Developers</td>

<td><nobr>**Payment Flow, Seconds**</nobr></td>

<td>Общая продолжительность обработки платежа</td>

</tr>

</tbody>

</table>

Метрики могут быть агрегированы различными способами. Ниже приведено описание каждого типа агрегации, который вы увидите на ваших дашбордах:

<table>

<thead>

<tr>

<th></th>

<th></th>

</tr>

</thead>

<tbody>

<tr>

<td>**Count**</td>

<td>Сколько раз произошло отслеживаемое событие. По умолчанию используется для **Invoices**, **Paying Users**, и.т.д.</td>

</tr>

<tr>

<td>**Sum**</td>

<td>Какова общая сумма числовых значений, связанных с отслеживаемым событием. По умолчанию используется для **Gross Revenue**, **Virtual Currency Amount**, и.т.д.</td>

</tr>

<tr>

<td>**Average**</td>

<td>Каково среднее значение метрики. Это будет использоваться для метрик, содержащих процентные отношения, поэтому не имеет смысла использовать такую агрегацию для метрик вида **Sum**. По умолчанию используется для **Average Payment Amount**, **Churn Users Percent**, и.т.д.</td>

</tr>

<tr>

<td>**Maximum**</td>

<td>Каково было максимальное значение данной метрики</td>

</tr>

<tr>

<td>**Minimum**</td>

<td>Каково было минимальное значение данной метрики</td>

</tr>

</tbody>

</table>

</div>

</div>

<div class="section-content">

<div class="section-description">

# [FAQ](#faq_data_portal)

**Q.** Сколько это стоит?

**A.** Для партнеров Xsolla это бесплатно.

* * *

**Q.** Как я могу активировать data portal для моего аккаунта?

**A.** Вам необходимо иметь активный проект с завершенными платежами. Вы можете активировать data portal в [личном кабинете Xsolla](https://publisher.xsolla.com)

* * *

**Q.** В каких валютах данные?

**A.** Доступно три валюты: Доллары США, Евро и российские Рубли. Также существует возможность фильтровать данные по валюте платежа.

* * *

**Q.** Как я могу загрузить свои собственные данные в [Slemma](https://slemma.com)?

**A.** Вы имеете несколько возможностей для загрузки дополнительных данных: загрузка файла с вашего компьютера или облачного хранилища, или напрямую подключиться к вашей БД. Подробная информация расположена в [базе знаний Slemma](http://support.slemma.com)

* * *

**Q.** Я обеспокоен конфиденциальностью и сохранностью моих данных.

**A.** Мы храним все данные в собственном защищенном хранилище данных Xsolla внутри изолированного приватного облака Amazon Web Service. Все данные передаются в/из хранилища через зашифрованное соединение TLC. Необработанные платежные данные недоступны в [Slemma](https://slemma.com). Доступны только агреггированные данные, без персональной пользовательской информации. Мы применяем принципы наименьших привилегий, файерволлы, шифрования и других технологические и эксплуатационные подходы, чтобы сохранить ваши данные в безопасности.

* * *

**Q.** В данной аналитике не хватает некотрых данных, доступных в [личном кабинете Xsolla](https://publisher.xsolla.com). Как я могу получить их в [Slemma](https://slemma.com)?

**A.** Отправьте запрос на email [dataportal@xsolla.com](mailto:dataportal@xsolla.com)

* * *

**Q.** Возможна ли выгрузка данных из [Slemma](https://slemma.com)?

**A.**Вы можете скачивать графики и их данные в различных форматах из [Slemma](https://slemma.com), кликнув правой кнопкой мыши по объекту и выбрав тип файла. Также вы можете скачать дашборд целиком в PDF или PNG формате. Если вам нужны необработанные данные вы можете использовать [Xsolla Reports API](http://developers.xsolla.com/api_v2.html#reports).

* * *

**Q.** Могу ли я использовать данную аналитику для проверки финансовых отчетов?

**A.** Нет, данные могут быть точны не на 100%, так как они используют среднесуточный обменных курс.

* * *

**Q.** Как часто обновляются данные?

**A.** Данные обновляются ежедневно в 2:00 AM UTC

* * *

**Q.** Насколько точны метики?

**A.** Мы получаем все метрики "на лету" из необработанных данных в нашем хранилище данных. Данный подход гарантирует точность для метрик с любой комбинацией группировки или фильтрации, особенно для подсчета количества уникальных значений или среднего метрик, к примеру, **Paying Users** и **Average Payment Amount**. Однако, мы не может предоставлять абсолютно точные финансовые данные, так как мы конвертируем платежные суммы в различный валютах со среднесуточным обменным курсом и используем округление до двух знаков после разделителя. Это означает, что разница редко превышает значение в $0.01.

* * *

**Q.** [Slemma](https://slemma.com) и аналитика в [личном кабинете Xsolla](https://publisher.xsolla.com) показывают разные значения. Почему?

**A.** Данные в [Slemma](https://slemma.com) в UTC таймзоне, тогда как данные в [личном кабинете Xsolla](https://publisher.xsolla.com) в UTC+3 таймзоне. В будущем мы собираемся убрать такое поведение и показывать все данные в UTC таймзоне.

* * *

**Q.** Как я могу пригласить другого пользователя для сотрудничества?

**A.** Когда вы активируете аналитику в [личном кабинете Xsolla](https://publisher.xsolla.com) вы можете выбрать членов вашей команды и выслать им приглашение (по умолчанию все пользователи). После регистрации в [Slemma](https://slemma.com), вы можете пригласить нового пользователя в настройках [Users and groups](https://slemma.com/team) .

* * *

**Q.** Как я могу создать свой собственный отчет?

**A.** Да, вы действительно можете сделать это!

* * *

**Q.** Какие функции обеспечивает [Slemma](https://slemma.com)?

**A.** Командный совместный доступ к дашбордам, комментирование, аннотации, управление доступом и дашборды автоматически обновляются.

* * *

**Q.** У меня есть другие вопросы о [Slemma](https://slemma.com)…

**A.** Используйте ‘Click here for help'-виджет в левой нижней стороне [Slemma](https://slemma.com) для получения доступа к базе знаний или контакта с саппортом при прмощи того же виджета.

* * *

**Q.** Как связать несколько аккаунтов в личном кабинете Xsolla со [Slemma](https://slemma.com)?

**A.** Свяжитесь с [dataportal@xsolla.com](mailto:dataportal@xsolla.com)

* * *

**Q.** Я не могу найти свой вопрос в данном списке…

**A.** Не стесняйтесь обращатьс к нам по любым вопросам по адресу [dataportal@xsolla.com](mailto:dataportal@xsolla.com)

</div>

</div>

</div>

<div class="content">

<div class="section-content">

<div class="section-description">

# [Xsolla Network](#xsolla_network)

Xsolla Network — глобальное решение, которое помогает создать бренд игры, найти новых пользователей и распространить игру через доступ к десяткам аффилированных сетей, миллионам инфлюенсеров и сотням игровых медиа-порталов из одного места. Revenue Share или кампании, основанные на CPA легко настраиваются и запускаются за несколько минут, и, поскольку Xsolla интегрирована со всеми аффилированными лицами, разработчику игры не требуется дополнительно интегрироваться. Разработчик игр могут распространять свои предложения или сообщения для инфлюенсеров и игровых платформ и платить прямо из Личного Кабинета Xsolla, без необходимости подписания соглашения с каждым из них, экономя время, деньги и ресурсы R&D.

*   Привлечение новых пользователей без предварительной оплаты;
*   Вы можете сами определять уровень рекламы, в зависимости от процента, который вы готовы платить;
*   Xsolla Network была протестирована с Life is Feudal, и показала себя эффективной;
*   4M инфлюенсеров на более чем 10 самых популярных платформах;
*   До 100 аффилированных сетей;
*   Распространение новостей во всех игровых медиа;
*   Инструменты отслеживания производительности и аналитики позволяют оценивать эффективность кампании по приобретению пользователей с помощью отслеживаемых ссылок, рекламных кодов или ключей активации продукта.
*   Базовая интеграция не обязательна, если уже интегрирован Xsolla Login.

Xsolla Network — это часть продуктовой линейки Xsolla, и может быть использована вместе с Pay Station, Mobile Pay Station и/или Pay2Play. Для использования данного продукта необходимо реализовать подключение с одним из [модулей](http://developers.xsolla.com/).

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Схема взаимодействия](#interaction_diagram)

<div class="getting-started">![Xsolla Network](https://cdn.xsolla.net/developers.xsolla.com/images/network_scheme.4b806ebea8.png)</div>

1) Пользователь кликает на рекламный баннер и переходит на прокси-страницу в Xsolla, на которую передается информация об игре. Xsolla сохраняет utm-параметры из URL, включая уникальный ID события (например, Click ID), и создает универсальный параметр Tracking ID для дальнейшего взаимодействия.

2) Tracking ID сохраняется в cookie-файлах пользователя, пользователь автоматически перенаправляется на промо-страницу игры.

3) Пользователь начинает процесс регистрации в игре. Игра должна сохранить Tracking ID данного пользователя вместе с его данными в базе данных игры.

4) Игра уведомляет Xsolla об успешной регистрации пользователя через API метод.

5) При получении токена для инициализации интерфейса оплаты, необходимо добавить параметр Tracking ID. Когда платеж успешно совершен, Xsolla сохраняет данные о платеже вместе с Tracking ID в базе.

6) Информация, собранная на первом шаге, плюс данные об уникальном ID события (например, Click ID) передаются источнику трафика.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Руководство по интеграции](#integration_guide)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Изменения в получении токена](#token_receipt_changes)

Вам необходимо дополнительно передавать информацию о Tracking ID в JSON для получения токена. Tracking ID передается внутри объекта "user".

### [Пример запроса](#token_receipt_changes_пример-запроса)

        curl -v https://api.xsolla.com/merchant/merchants/{merchant_id}/token \
        -X POST \
        -u your_merchant_id:merchant_api_key \
        -H 'Content-Type:application/json' \
        -H 'Accept: application/json' \
        -d '
        {
            "user": {
                "id": {
                    "value": "1234567"
                },
                "tracking_id": {
                    "value": "trackingID"
                }
            },
            "settings": {
                "project_id": 14004
            }
        }'

Все параметры, которые уже присутствовали в JSON для получения токена, должны остаться без изменений.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Новый метод API](#new_api_method)

Когда пользователь с Tracking ID успешно регистрируется в игре, игра должна прислать запрос при помощи API метода.

### [Пример запроса](#new_api_method_пример-запроса)

    curl -v 'https://api.xsolla.com/merchant/merchants/{merchant_id}/xsolla_network/
    user_register/{tracking_id}' \
    -X PUT \
    -u merchant_id:merchant_api_key

<table>

<thead>

<tr>

<th>Параметр</th>

<th>Тип</th>

<th>Описание</th>

</tr>

</thead>

<tbody>

<tr>

<td>merchant_id</td>

<td>int</td>

<td>ID мерчанта.</td>

</tr>

<tr>

<td>tracking_id</td>

<td>string</td>

<td>Tracking ID.</td>

</tr>

</tbody>

</table>

### [Пример успешного ответа](#new_api_method_пример-успешного-ответа)

    HTTP/1.1 204 No Content

</div>

</div>

</div>

<div class="content">

<div class="section-content">

<div class="section-description">

# [Pay2Play](#pay2play)

Модуль **Pay2Play** позволяет разработчикам игр продавать пин-коды напрямую с сайта игры. Для перехода в магазин используется виджет Pay2Play. Модуль имеет несколько вариантов интеграции и предлагает следующие возможности:

*   Выбор платформы для каждой DRM
*   Разные цены для разных DRM
*   Выбор размера и цветовой темы виджета
*   Чаевые разработчику

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Пользовательский сценарий](#user_flow)

![](https://cdn.xsolla.net/developers.xsolla.com/images/Pay2Play_userflow.5827dbc490.png)

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Варианты интеграции](#integration_types)

Возможны два варианта интеграции модуля — базовая и расширенная.

### [Базовая интеграция](#integration_types_базовая-интеграция-basic_integration)

![](https://cdn.xsolla.net/developers.xsolla.com/images/Pay2Play_partnerflow_basic.6fbae1f6dc.png)

Особенности базовой интеграции:

*   Быстрый запуск модуля
*   Не требует генерации токена и наличия серверной части
*   Подходит для продажи игры без предварительной авторизации пользователя

### [Расширенная интеграция](#integration_types_расширенная-интеграция-advanced_integration)

![](https://cdn.xsolla.net/developers.xsolla.com/images/Pay2Play_partnerflow_adv.1bfcc4e872.png)

Особенности расширенной интеграции:

*   Позволяет безопасно передать данные пользователя для дальнейшей привязки покупки на стороне игры
*   Требует реализации серверной части

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Руководство по базовой интеграции](#basic_integration_guide)

Для базовой интеграции модуля необходимо:

1.  Зарегистрироваться в [Личном Кабинете Xsolla](https://publisher.xsolla.com/).
2.  [Создать проект](../pay2play.html#basic_create_project).
3.  [Настроить модуль](../pay2play.html#basic_create_module).
4.  [Протестировать](../pay2play.html#basic_testing) процесс оплаты.
5.  Добавить на страницу игры [виджет Pay2Play](../pay2play.html#basic_widget).
6.  Подписать договор.

В процессе интеграции понадобятся следующие параметры:

*   ID проекта. Отображается в URL Личного Кабинета при переходе в настройки проекта — _<span>htt</span>ps://publisher.xsolla.com/{merchant_id}/projects/{project_id}/_.

<aside class="notise2">Данное руководство включает в себя минимальный набор настроек для быстрого запуска модуля. Полный список параметров описан в [справочнике API](../api_v2.html). Если у вас возникли вопросы по подключению, пожалуйста, обратитесь к аккаунт-менеджеру проекта.</aside>

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Создание проекта](#basic_create_project)

1.  Перейдите в раздел **Проекты** и нажмите кнопку **Создать проект**.
2.  В настройках проекта:  

    *   Установите переключатель **HTTP оповещения** в положение **Выкл.**
    *   Установите переключатель **Беcсерверная интеграция** в положение **Вкл.**
    *   Включите модуль **Pay2Play**.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Настройка модуля](#basic_create_module)

1.  Перейдите в настройки модуля **Pay2Play** и задайте базовые настройки игры:
    *   Название.
    *   Описание.
    *   Системные требования.
    *   SKU - уникальный идентификатор.
    *   Дата релиза.
    *   Изображение.
    *   DRM.
    *   Платформы, которые поддерживаются выбранными DRM.
2.  Нажмите кнопку **Далее**.
3.  Настройте цены для выбранных DRM. Нажмите кнопку **Далее**.
4.  Установите переключатель **Загруженные коды** в положение **Вкл.**
5.  Загрузите пин-коды для выбранных DRM.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Тестирование процесса оплаты](#basic_testing)

Xsolla Sandbox (“песочница”) — это автономная рабочая среда, в которой доступны все функции Live режима, кроме проведения реальных платежей. Вы можете получить доступ к Sandbox, отправив параметр _"settings.mode" = "sandbox"_ в объекте **access_data**. Параметры и структура JSON внутри объекта **access_data** идентичны JSON в запросе на получение [токена](../api_v2.html#token).

<aside class="notise2">Для проведения тестового платежа не нужен пинкод. Если вы хотите провести платеж с погашением пинкода, эту операцию необходимо выполнять в Live режиме.</aside>

Тестирование оплаты банковской картой:

1.  Откройте магазин в sandbox-режиме.
2.  Выберите предмет покупки.
3.  Выберите группу способов оплаты **Банковские карты**.
4.  Введите реквизиты тестовой карты. Остальные поля могут быть заполнены любыми данными. Вы также можете указать неверные реквизиты (номер карты, срок действия или CVV) для генерации ошибки.

[Список банковских карт для тестирования](../api_v2.html#test_cards)

**Обратите внимание!** Платежи банковской картой в sandbox-режиме могут быть проведены только в валюте USD, EUR, RUB, GBP, SGD, HKD или THB.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Интеграция виджета Pay2Play](#basic_widget)

[Виджет Pay2Play](https://github.com/xsolla/pay2play-widget) открывает магазин в lightbox (для полноэкранной версии) или в новом окне (для мобильных устройств и планшетов). Тип устройства определяется автоматически. Для получения кода виджета откройте настройки модуля в Личном Кабинете и перейдите на вкладку **Опубликовать**. Скопируйте код нужного виджета и добавьте его на сайт игры. Рекомендуется использовать асинхронную загрузку.

Пример асинхронной загрузки

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang" data-lang="html">HTML</div>

</div>

</div>

     <script>
         var access_data = {"settings":{"project_id":14004},"purchase":{"pin_codes":{"codes":[{"digital_content":"game_sku"}]}}};
         var target_element = "#widget-example-element";
         var s = document.createElement('script');
         s.type = "text/javascript";
         s.async = true;
         s.src = "//static.xsolla.com/embed/pay2play/2.1.0/widget.min.js";
         s.addEventListener('load', function (e) {
             var widgetInstance = XPay2PlayWidget.create(access_data,target_element);
         }, false);
         var head = document.getElementsByTagName('head')[0];
         head.appendChild(s);
     </script>

Полный список параметров инициализации виджета доступен в [справочнике API](../api_v2.html#pay2play_widget), инструкция по добавлению виджета — в [проекте Github](https://github.com/xsolla/pay2play-widget).

<aside class="notise2">**Обратите внимание!** Чтобы начать принимать реальные платежи, необходимо подписать договор.</aside>

</div>

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Руководство по расширенной интеграции](#advanced_integration_guide)

Для расширенной интеграции модуля необходимо:

1.  Зарегистрироваться в [Личном Кабинете Xsolla](https://publisher.xsolla.com/).
2.  [Создать проект](../pay2play.html#advanced_create_project).
3.  [Настроить модуль](../pay2play.html#advanced_create_module).
4.  [Получить токен](../pay2play.html#advanced_get_token).
5.  [Настроить обработку оповещений](../pay2play.html#advanced_setup_webhooks).
6.  [Протестировать](../pay2play.html#advanced_testing) процесс оплаты.
7.  Добавить на страницу игры [виджет Pay2Play](../pay2play.html#advanced_widget) и подписать договор.

В процессе интеграции понадобятся следующие параметры:

*   ID мерчанта. Отображается в URL Личного Кабинета — _<span>ht</span>tps://publisher.xsolla.com/{merchant_id}/_.
*   Ключ API. Генерируется в Личном Кабинете в разделе **Настройки -> Компания**.
*   ID проекта. Отображается в URL Личного Кабинета при переходе в настройки проекта — _<span>htt</span>ps://publisher.xsolla.com/{merchant_id}/projects/{project_id}/_.
*   Секретный ключ проекта. Генерируется на странице настройки проекта.

<aside class="notise2">Данное руководство включает в себя минимальный набор настроек для быстрого запуска модуля. Полный список параметров описан в [справочнике API](../api_v2.html). Если у вас возникли вопросы по подключению, пожалуйста, обратитесь к аккаунт-менеджеру проекта.</aside>

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Создание проекта](#advanced_create_project)

1.  Перейдите в раздел **Проекты** и нажмите кнопку **Создать проект**.
2.  В настройках проекта:
    *   Установите переключатель **HTTP оповещения** в положение **Вкл.**
    *   Укажите URL оповещений.
    *   Сгенерируйте секретный ключ проекта для подписи оповещений.
    *   Установите переключатель **Беcсерверная интеграция** в положение **Выкл.**
    *   Включите модуль **Pay2Play**.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Настройка модуля](#advanced_create_module)

1.  Перейдите в настройки модуля **Pay2Play** и задайте базовые настройки игры:
    *   Название.
    *   Описание.
    *   Системные требования.
    *   SKU - уникальный идентификатор.
    *   Дата релиза.
    *   Изображение.
    *   DRM.
    *   Платформы, которые поддерживаются выбранными DRM.
2.  Нажмите кнопку **Далее**.
3.  Настройте цены для выбранных DRM. Нажмите кнопку **Далее**.
4.  Установите переключатель **Загруженные коды** в положение **Вкл.**
5.  Загрузите пин-коды для выбранных DRM.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Получение токена магазина](#advanced_get_token)

Для интеграции магазина необходимо получить токен. Токен — это строка, в которой содержится информация об игре, пользователе и параметрах платежа. Xsolla API использует Basic HTTP-аутентификацию. Укажите свой ID мерчанта в качестве username и ключ API в качестве password.

Для получения доступа к sandbox-режиму используется параметр "mode" = "sandbox".

URL получения токена:

`ht<span>tps://api.xsolla.com/merchant/merchants/{merchant_id}/token</span>`

В HTTP POST запросе вы можете указать параметры, которые нужно передать на платежный интерфейс. Запрос и ответ передаются в JSON формате.

Ниже указан пример получения токена на PHP с использованием [Xsolla PHP SDK](../sdk.html). Если вы разрабатываете на другом языке, можно использовать _CURL_ пример (нажмите на кнопку CURL).

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang active" data-lang="php">PHP</div>

<div class="lang" data-lang="shell">CURL</div>

</div>

</div>

    <?php

    use Xsolla\SDK\API\XsollaClient;
    use Xsolla\SDK\API\PaymentUI\TokenRequest;

    $tokenRequest = new TokenRequest($projectId, $userId);
    $tokenRequest->setUserEmail('email@example.com')
        ->setExternalPaymentId('12345')
        ->setSandboxMode(true)
        ->setUserName('USER_NAME')
        ->setCustomParameters(array('key1' => 'value1', 'key2' => 'value2'));

    $xsollaClient = XsollaClient::factory(array(
        'merchant_id' => MERCHANT_ID,
        'api_key' => API_KEY
    ));
    $token = $xsollaClient->createPaymentUITokenFromRequest($tokenRequest);

        curl -v https://api.xsolla.com/merchant/merchants/{merchant_id}/token \
        -X POST \
        -u your_merchant_id:merchant_api_key \
        -H 'Content-Type:application/json' \
        -H 'Accept: application/json' \
        -d '
        {
            "user": {
                "id": {
                    "value": "1234567"
                },
                "email": {
                    "value": "email@example.com"
                }
            },
            "settings": {
                "project_id": 14004,
                "mode": "sandbox"
            }
        }'

</div>

Полный список параметров доступен в [справочнике API](../api_v2.html#token).

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Настройка оповещений](#advanced_setup_webhooks)

Xsolla отправляет проекту следующие типы оповещений (webhooks):

*   Проверка существования пользователя
*   Успешный платеж
*   Отмена платежа

Чтобы подтвердить получение оповещения, ваш сервер должен вернуть 204 HTTP код без тела сообщения. Механизм работы оповещений с примерами обработки подробно описан в [справочнике API](../api_v2.html#webhooks).

### [Формирование подписи](#advanced_setup_webhooks_формирование-подписи)

Процесс формирования подписи включает следующие шаги:

1.  Данные, переданные в запросе от сервера Xsolla, и секретный ключ проекта (генерируется на странице настройки проекта) конкатенируются в строку.
2.  Полученная строка хешируется с помощью SHA1 хеш-алгоритма.
3.  Подпись передается в Signature заголовке.

При обработке оповещения необходимо проверить, что полученная подпись и подпись, переданная в Signature заголовке, совпадают.

### [Проверка существования пользователя](#advanced_setup_webhooks_проверка-существования-пользователя)

Сервер Xsolla посылает запрос на URL оповещений проекта, чтобы проверить существование персонажа в игре.

Пример запроса

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang active" data-lang="php">PHP</div>

<div class="lang" data-lang="shell">CURL</div>

</div>

</div>

    $request = array(
        'notification_type' => 'user_validation',
        'user' => array(
            'ip' => '127.0.0.1',
            'phone' => '18777976552',
            'email'=> 'email@example.com',
            'id'=> '1234567',
            'country' => 'US'
        )
    )

    curl -v https://example.com/ \
    -X POST \
    -H 'Content-Type:application/json' \
    -H 'Accept: application/json' \
    -H 'Authorization: Signature 13342703ccaca5064ad33ba451d800c5e823db8f' \
    -d '
    {
        "notification_type": "user_validation",
        "user": {
            "ip": "127.0.0.1",
            "phone": "18777976552",
            "email": "email@example.com",
            "id": "1234567",
            "country": "US"
        }
    }'

Полный список параметров доступен в [справочнике API](../api_v2.html#validate_user).

### [Успешный платеж](#advanced_setup_webhooks_успешный-платеж)

Когда пользователь завершает процесс оплаты, сервер Xsolla отправляет проекту оповещение с информацией о платеже.

Пример запроса

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang active" data-lang="php">PHP</div>

<div class="lang" data-lang="shell">CURL</div>

</div>

</div>

    $request = array(
        'notification_type' => 'payment',
        'purchase' => array(
            'virtual_items' => array(
                'items' => array(
                    0 => array(
                        'sku' => 'test_item1',
                        'amount' => 1,
                        ),
                    1 => array(
                        'sku' => 'test_item2',
                        'amount' => 1,
                        ),
                    2 => array(
                        'sku' => 'test_item3',
                        'amount' => 1,
                        ),
                )
            ),
            'total' => array(
                'currency' => 'USD',
                'amount' => 9.99
            )
        ),
        'user' => array(
            'ip' => '127.0.0.1',
            'phone' => '18777976552',
            'email' => 'email@example.com',
            'id' => '1234567',
            'country' => 'US'
        ),
        'transaction' => array(
            'id' => 87654321,
            'payment_date' => '2014-09-23T19:25:25+04:00',
            'payment_method' => 1380,
            'dry_run' => 1
        ),
        'payment_details' => array(
            'payment' => array(
                'currency' => 'USD',
                'amount' => 9.99
            ),
            'vat' => array(
                'currency' => 'USD',
                'amount' => 0
            ),
            'payout_currency_rate' => 1,
            'payout' => array(
                'currency' => 'USD',
                'amount' => 9.49
            ),
            'xsolla_fee' => array(
                'currency' => 'USD',
                'amount' => 0.19
            ),
            'payment_method_fee' => array(
                'currency' => 'USD',
                'amount' => 0.31
            )
        )
    )

    curl -v https://example.com/ \
    -X POST \
    -H 'Content-Type:application/json' \
    -H 'Accept: application/json' \
    -H 'Authorization: Signature 13342703ccaca5064ad33ba451d800c5e823db8f' \
    -d '
    {
        "notification_type": "payment",
        "purchase": {
            "virtual_items": {
                "items": [
                    {
                        "sku": "test_item1",
                        "amount": 1
                    },
                    {
                        "sku": "test_item2",
                        "amount": 1
                    },
                    {
                        "sku": "test_item3",
                        "amount": 2
                    },
                ]
            },
            "total": {
                "currency": "USD",
                "amount": 9.99
            }
        },
        "user": {
            "ip": "127.0.0.1",
            "phone": "18777976552",
            "email": "email@example.com",
            "id": "1234567",
            "country": "US"
        },
        "transaction": {
            "id": 87654321,
            "payment_date": "2014-09-23T19:25:25+04:00",
            "payment_method": 1380,
            "dry_run": 1
        },
        "payment_details": {
            "payment": {
                "currency": "USD",
                "amount": 9.99
            },
            "vat": {
                "currency": "USD",
                "amount": 0
            },
            "payout_currency_rate": 1,
            "payout": {
                "currency": "USD",
                "amount": 9.49
            },
            "xsolla_fee": {
                "currency": "USD",
                "amount": 0.19
            },
            "payment_method_fee": {
                "currency": "USD",
                "amount": 0.31
            }
        }
    }'

Полный список параметров доступен в [справочнике API](../api_v2.html#payment).

### [Отмена платежа](#advanced_setup_webhooks_отмена-платежа)

Если пользователь отменяет платеж, сервер Xsolla отправляет проекту оповещение с информацией о платеже.

Пример запроса

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang active" data-lang="php">PHP</div>

<div class="lang" data-lang="shell">CURL</div>

</div>

</div>

    $request = array(
        'notification_type' => 'refund',
        'purchase' => array(
            'virtual_currency' => array(
                'name' => 'Coins',
                'quantity' => 100,
                'currency' => 'USD',
                'amount' => 9.99
            ),
            'total' => array(
                'currency' => 'USD',
                'amount' => 9.99
            )
        ),
        'user' => array(
            'ip' => '127.0.0.1',
            'phone' => '18777976552',
            'email' => 'email@example.com',
            'id' => '1234567',
            'country' => 'US'
        ),
        'transaction' => array(
            'id' => 87654321,
            'payment_date' => '2014-09-23T19:25:25+04:00',
            'payment_method' => 1380,
            'dry_run' => 1
        ),
        'refund_details' => (
                'code' => 1,
                'reason' => 'Fraud'
        ),
        'payment_details' => array(
            'payment' => array(
                'currency' => 'USD',
                'amount' => 9.99
            ),
            'vat' => array(
                'currency' => 'USD',
                'amount' => 0
            ),
            'payout_currency_rate' => 1,
            'payout' => array(
                'currency' => 'USD',
                'amount' => 9.49
            ),
            'xsolla_fee' => array(
                'currency' => 'USD',
                'amount' => 0.19
            ),
            'payment_method_fee' => array(
                'currency' => 'USD',
                'amount' => 0.31
            )
        )
    );

    curl -v https://example.com/ \
    -X POST \
    -H 'Content-Type:application/json' \
    -H 'Accept: application/json' \
    -H 'Authorization: Signature 13342703ccaca5064ad33ba451d800c5e823db8f' \
    -d '
    {
        "notification_type":"refund",
        "purchase":{
            "virtual_currency":{
                "name": "Coins",
                "quantity":10,
                "currency":"USD",
                "amount":100
            },
            "subscription":{
                "plan_id": "b5dac9c8",
                "subscription_id": "10",
                "date_create": "2014-09-22T19:25:25+04:00",
                "currency": "USD",
                "amount": 9.99
            },
            "checkout":{
                "currency":"USD",
                "amount":50
            },
            "virtual_items":{
                "items":[
                    {
                        "sku": "test_item1",
                        "amount":1
                    }
                ],
                "currency":"USD",
                "amount":50
            },
            "total":{
                "currency":"USD",
                "amount":200
            }
        },
        "user": {
            "ip": "127.0.0.1",
            "phone": "18777976552",
            "email": "email@example.com",
            "id": "1234567",
            "name": "Xsolla User",
            "country": "US"
        },
        "transaction":{
            "id":1,
            "external_id":1,
            "dry_run":1,
            "agreement":1
        },
        "refund_details":{
            "code":1,
            "reason":"Fraud"
        },
        "payment_details":{
            "xsolla_fee":{
                "currency":"USD",
                "amount":"10"
            },
            "payout":{
                "currency":"USD",
                "amount":"200"
            },
            "payment_method_fee":{
                "currency":"USD",
                "amount":"20"
            },
            "payment":{
                "currency":"USD",
               "amount":"230"
            }
        }
    }'

</div>

Полный список параметров доступен в [справочнике API](../api_v2.html#refund).

### [Тестирование оповещений](#advanced_setup_webhooks_тестирование-оповещений)

Чтобы протестировать обработчик оповещений:

1.  Откройте настройки модуля в Личном Кабинете.
2.  Перейдите на вкладку **Тестирование**.
3.  Введите тестовые данные и нажмите кнопку **Запустить тесты**: сервер Xsolla отправит все типы оповещений.
4.  Если скрипт вернул корректный ответ, тест помечается зеленым цветом, в случае ошибки — красным.

## [Тестирование процесса оплаты](#advanced_testing)

Xsolla Sandbox ("песочница") — это автономная рабочая среда, в которой доступны все функции Live режима, кроме проведения реальных платежей. Вы можете получить доступ к Sandbox, отправив параметр _"mode" = "sandbox"_ при [получении токена](../api_v2.html#token).

<aside class="notise2">Для проведения тестового платежа не нужен пинкод. Если вы хотите провести платеж с погашением пинкода, эту операцию необходимо выполнять в Live режиме.</aside>

Тестирование оплаты банковской картой:

1.  Откройте магазин в sandbox-режиме.
2.  Выберите предмет покупки.
3.  Выберите группу способов оплаты **Банковские карты**.
4.  Введите реквизиты карты из таблицы ниже. Остальные поля могут быть заполнены любыми данными. Вы также можете указать неверные реквизиты (номер карты, срок действия или CVV) для генерации ошибки.

[Список банковских карт для тестирования](../api_v2.html#test_cards)

**Обратите внимание!** Платежи банковской картой в sandbox-режиме могут быть проведены только в валюте USD, EUR, RUB, GBP, SGD, HKD или THB.

## [Интеграция виджета Pay2Play](#advanced_widget)

[Виджет Pay2Play](https://github.com/xsolla/pay2play-widget) открывает магазин в lightbox (для полноэкранной версии) или в новом окне (для мобильных устройств и планшетов). Тип устройства определяется автоматически. Для получения кода виджета откройте настройки модуля в Личном Кабинете и перейдите на вкладку **Опубликовать**. Скопируйте код нужного виджета и добавьте его на сайт игры. Рекомендуется использовать асинхронную загрузку.

Пример асинхронной загрузки

<div class="content-code">

<div class="language-switcher">

<div class="languages">

<div class="lang" data-lang="html">HTML</div>

</div>

</div>

     <script>
         var access_data = {"settings":{"project_id":14004},"purchase":{"pin_codes":{"codes":[{"digital_content":"game_sku"}]}}};
         var target_element = "#widget-example-element";
         var s = document.createElement('script');
         s.type = "text/javascript";
         s.async = true;
         s.src = "//static.xsolla.com/embed/pay2play/2.1.0/widget.min.js";
         s.addEventListener('load', function (e) {
             var widgetInstance = XPay2PlayWidget.create(access_data,target_element);
         }, false);
         var head = document.getElementsByTagName('head')[0];
         head.appendChild(s);
     </script>

Полный список параметров инициализации виджета доступен в [справочнике API](../api_v2.html#pay2play_widget), инструкция по добавлению виджета — в [проекте Github](https://github.com/xsolla/pay2play-widget).

<aside class="notise2">**Обратите внимание!** Чтобы начать принимать реальные платежи, необходимо подписать договор.</aside>

</div>

</div>

</div>

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Дополнительные возможности](#additional_features)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Чаевые разработчику](#tips)

Проект может получать чаевые с каждой покупки. Для включения опции откройте настройки цен аддона и установите переключатель **Использовать чаевые в виджете Pay2Play** в положение **Вкл**. Для каждой добавленной валюты доступны три предустановленные суммы чаевых.

Пользователь сможет выбрать сумму чаевых перед переходом в магазин, чаевые будут добавлены к стоимости покупки.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Доставка пин-кодов пользователю по API](#api_pin_codes)

Вы можете отправлять пин-коды при каждой покупке игры вместо загрузки файла с пин-кодами. Для включения опции необходимо:

*   реализовать обработку оповещения [Получение пин-кода](../api_v2.html#get_pin_code);
*   в настройках аддона на вкладке **Загрузка кодов** установить переключатель **По требованию** в положение **Вкл.**, переключатель **Загруженные коды** — в положение **Выкл.**

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Ограничение продаж пин-кодов](#limit_sales)

Проект может ограничить количество доступных к продаже пин-кодов. По мере продажи пин-кодов вы будете получать уведомления по электронной почте. Первое уведомление будет отправлено, когда в продаже останется не более 100 пин-кодов, второе — когда все пин-коды будут проданы. При попытке приобрести пин-коды сверх лимита проведение платежа блокируется.

![](https://cdn.xsolla.net/developers.xsolla.com/images/sold_out.58a2e21c8c.png)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Региональные ограничения продаж](#regional_sale_restrictions)

Модуль **Pay2Play** позволяет настроить региональные ограничения продажи пин-кодов:

*   задать различную стоимость для отдельных стран или групп стран;
*   запретить продажу в определенных странах.

После выполнения необходимых настроек при покупке пин-кода пользователь увидит предупреждение (если страна пользователя попадает под заданные ограничения). В странах, для которых продажа пин-кодов запрещена, проведение платежа блокируется.

![](https://cdn.xsolla.net/developers.xsolla.com/images/reglock.4effd3ed91.png)

Для подключения опции обратитесь к аккаунт-менеджеру проекта. По каждой платформе, для которой необходимо настроить региональные ограничения, вам потребуется следующая информация:

*   Тип ограничения:
    *   на активацию — пин-код может быть активирован только в определенных странах;
    *   на запуск — пин-код может быть активирован в любой стране, игра может быть запущена только в определенных странах;
    *   на активацию и на запуск — активация пин-кода и запуск игры могут быть выполнены только в определенных странах.
*   Список групп стран, для которых стоимость пин-кодов будет отличаться от базовых настроек модуля.
*   Настройки для каждой группы стран:
    *   Название группы.
    *   SKU — уникальный идентификатор группы.
    *   Список цен в разных валютах. Обязательно укажите цену в валюте, выбранной в настройках модуля по умолчанию.
    *   Список стран, входящих в группу.
*   Список стран, для которых продажа пин-кодов должна быть запрещена (при необходимости).

В рамках одной платформы страна может входить только в одну из групп с настройками цен или в список стран с запретом продажи. В странах, не вошедших ни в один из списков, продажа пин-кодов будет осуществляться без каких-либо ограничений и по ценам, указанным в базовых настройках модуля.

**Обратите внимание!** Если активация пин-кодов и запуск игры выполняются на вашей стороне или на стороне платформы, в день релиза игры необходимо загружать пин-коды с уже настроенными региональными ограничениями.

</div>

</div>

</div>

<div class="content">

<div class="section-content">

<div class="section-description">

# [Подарок другу](#gifting)

Вы можете дать возможность пользователям приобретать пакеты виртуальной валюты, виртуальные товары или ключи доступа в качестве подарка друзьям в игре. После успешной оплаты покупателю отправляется чек, получателю - письмо с информацией о подарке. Покупатель подарка также может скрыть свои данные и отправить подарок анонимно.

Опция имеет несколько вариантов интеграции и предлагает игровым проектам следующие варианты покупок подарка:

*   Покупка пакета виртуальной валюты
*   Покупка виртуальных товаров
*   Покупка ключа активации игры

Опция доступна только для проектов, у которых отключено хранение данных пользователей на стороне Xsolla.

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Сценарии взаимодействия](#-)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Передача списка друзей в токене](#-)

![](https://cdn.xsolla.net/developers.xsolla.com/images/type1_03.140efdf180.png)

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Передача списка друзей через API](#-api)

![](https://cdn.xsolla.net/developers.xsolla.com/images/type2_03.166b51efde.png)

</div>

</div>

<div class="section-content">

<div class="section-description">

# [Руководство по интеграции](#integration_guide)

В зависимости от модулей, которые включены для вашего проекта, доступны следующие варианты интеграции:

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Модуль Pay2Play](#pay2play_module)

Для подключения модуля необходимо:

1.  [Настроить](./pay2play.html) модуль Pay2Play.
2.  Связаться с аккаунт-менеджером проекта для включения опции.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Модуль виртуальной валюты, модуль виртуальных товаров или модуль реальной валюты](#virtual_items_virtual_currency_payment_wall_modules)

Для подключения опции необходимо:

1.  Настроить модуль [виртуальной валюты](./virtual_currency.html), [виртуальных товаров](./virtual_items.html) или модуль [реальной валюты](./payment_wall.html).
2.  Реализовать [метод API](#friend_via_api) для передачи списка друзей в Xsolla или добавить объект с данными о друзьях в [запрос на получение токена](#friend_via_token).
3.  Реализовать [обработку оповещения](#setup_webhooks) об успешной оплате с добавленными данными о подарке.
4.  Связаться с аккаунт-менеджером проекта для включения опции.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Настройка модуля](#create_module)

Для подключения опции необходимо запустить модуль виртуальной валюты, виртуальных товаров или модуль виртуальной валюты.

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Передача списка друзей в токене](#friend_via_token)

При необходимости в запрос можно добавить массив со списком друзей пользователя. Если массив содержит всего один элемент, переданный друг автоматически определяется как получатель подарка. В [запросе на получение токена](./api_v2.html#token) можно передавать не более 100 друзей. В запрос также можно включить объект с данными о подарке.

**Пример запроса**

    "purchase":{

       "virtual_currency":{

           "quantity":100

       },

       "description":{

           "value":"Test Purchase"

       },

       "gift":{

           "giver_id":"John Smith",

           "message":"GG WP",

           "hide_giver_from_receiver" : true,

           "friends": [

           {

            "id": "123",

            "name": "captain",

            "email": "captain@ship.com"

           }]

       }

    }

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Передача списка друзей по запросу к API](#friend_via_api)

Xsolla отправляет проекту [запрос на получение списка друзей](./api_v2.html#friends_list) по адресу, указанному в качестве webhook URL в настройках проекта.

**Формирование подписи**

Процесс формирования подписи включает следующие шаги:

1.  Параметры, переданные в запросе от сервера Xsolla, сортируются в алфавитном порядке.
2.  Значения параметров и секретный ключ проекта (генерируется на странице настройки проекта) конкатенируются в строку.
3.  Полученная строка хешируется с помощью SHA1 хеш-алгоритма.
4.  Подпись передается в параметре sign.

При обработке запроса к API необходимо проверить, что полученная подпись и подпись, переданная в параметре sign, совпадают.

### [Получение списка друзей](#friend_via_api_получение-списка-друзей)

**Пример запроса**

    $ curl -v 'https://your.webhook.url?notification_type=friends_list&user=user_id&query=frien&offset=10&limit=20&sign=12dfg3f5gdsf4g5s6dfg2sdg1' \
    -X GET \
    -u merchant_id:merchant_api_key

**Пример ответа**

    [
      {
      "friends": [
          {
            "id": "1",
            "name": "John Carter",
            "email": "carter@xsolla.com",
            "image_url": "https://partner/link/doctor.jpg"
          },
          {
            "id": "2",
            "name": "John Smith",
            "email": "smith@xsolla.com",
            "image_url": "https://partner/link/cook.jpg"
          }
        ],
      "total": 10
      }
    ]

</div>

</div>

<div class="section-content">

<div class="section-description">

## [Настройка оповещений](#setup_webhooks)

При включении модулей виртуальной валюты и виртуальных товаров обязательным шагом является обработка [оповещения Payments](./api_v2.html#payment). При включении опции Подарок другу в JSON оповещения добавляется новый объект gift.purchase.

**Пример запроса**

    $curl -v 'https://your.hostname/your/uri' \
    -X POST \
    -d '{
        "notification_type":"payment",
        "purchase":{
            "virtual_currency":{
                "name":"Coins",
                "sku":"test_package1",
                "quantity":10,
                "currency":"USD",
                "amount":100
            },
            "subscription":{
                "plan_id": "b5dac9c8",
                "subscription_id": "10",
                "product_id": "Demo Product",
                "date_create": "2014-09-22T19:25:25+04:00",
                "date_next_charge": "2014-10-22T19:25:25+04:00",
                "currency": "USD",
                "amount": 9.99
            },
            "checkout":{
                "currency":"USD",
                "amount":50
            },
            "virtual_items":{
                "items":[
                    {
                        "sku": "test_item1",
                        "amount":1
                    }
                ],
                "currency":"USD",
                "amount":50
            },
            "gift":{
                 "giver_ID":"John Smith",
                 "receiver_ID":"Ivan Ivanov",
                 "receiver_email":"example@example.com",
                 "message":"GG WP",
                 "hide_giver_from_receiver": true
            },
            "total":{
                "currency":"USD",
                "amount":200
            },
            "promotions":[{
                "technical_name":"Demo Promotion",
                "id":"853"
            }],
            "coupon":{
                 "coupon_code":"ICvj45S4FUOyy",
                 "campaign_code":"1507"
            }
        },
        "user": {
            "ip": "127.0.0.1",
            "phone": "18777976552",
            "email": "email@example.com",
            "id": "1234567",
            "name": "Xsolla User",
            "country": "US"
        },
        "transaction":{
            "id":1,
            "external_id":1,
            "payment_date":"2014-09-24T20:38:16+04:00",
            "payment_method":1,
            "dry_run":1,
            "agreement":1
        },
        "payment_details":{
            "payment":{
                "currency":"USD",
                "amount":230
            },
            "vat": {
                "currency": "USD",
                "amount": 0
            },
            "payout_currency_rate": 1,
            "payout":{
                "currency":"USD",
                "amount":200
            },
            "xsolla_fee":{
                "currency":"USD",
                "amount":10
            },
            "payment_method_fee":{
                "currency":"USD",
                "amount":20
            }
        },
        "custom_parameters":{
            "parameter1":"value1",
            "parameter2":"value2"
        }
    }'

</div>

</div>

</div>

<div class="content">

<div class="section-content">

<div class="section-description">

# [Запуск Pay Station на домене игры](#paystation_domain)

1.  Зарегистрировать новое доменное имя вида **secure.yourdomain.com**. При регистрации следует указать текущий IP-адрес домена **secure.xsolla.com** (запись типа A), либо указать алиас на **secure.xsolla.com** (запись типа CNAME).
2.  Выпустить валидный сертификат SSL для данного домена — **secure.yourdomain.com**.
3.  Генерация ключа и запроса на подпись сертификата (CSR) с использованием пакета openssl. В командной строке выполните следующие инструкции:

    *   **Генерация ключа:** _openssl genrsa -out server.key 2048_
    *   **Генерация CSR:** _openssl req -new -key server.key -out server.csr_

        Во время генерации следует отвечать на вопросы в интерактивном режиме.

        **Важно!** В поле **Common Name** нужно указать имя вашего домена (**secure.yourdomain.com**).

4.  Далее, на любом сайте, выдающем сертификаты (например, [GoDaddy](https://www.godaddy.com/web-security/ssl-certificate)) оформляется сертификат. В процессе оформления будет запрошен CSR — следует скопировать в поле ввода содержимое файла **server.csr**.

    После проверки принадлежности домена регистратор высылает подписанный сертификат.

5.  Выслать Xsolla ключ и сертификат на электронную почту [sysadmins@xsolla.com](mailto:sysadmins@xsolla.com) с темой письма: **[Ваша игра]: SSL Certificate**.
6.  При интеграции через **Pay Station Embed** необходимо указать в параметре "host" ссылку на интерфейс оплаты.

</div>

</div>

</div>